!function(t){"use strict";function e(t){return Object.prototype.toString.call(t)}function a(t){if(!t||1!==t.nodeType||"FORM"!==t.nodeName)throw new TypeError("Apply Validator() only on form element.");this.form=t,this.validators=[],t.classList.add("v-bound"),this.warningClass="warning",this.registeredUsernames=i,this.registeredEmails=r,this.readInputs(),this.bindSubmitValidator()}function n(){for(var t=document.querySelectorAll("form.validator"),e=[],n=0;n<t.length;n++)e.push(new a(t[n]))}var i=["a","aa","aaa","asd","asdf"],r=["a@example.com","aa@example.com","aaa@example.com","asd@example.com","asdf@example.com"];a.showRegisteredUsernames=function(){return i},a.showRegisteredEmails=function(){return r},a.prototype.readInputs=function(){for(var t,e,a,n,i,r,s,o="v-length",l="v-min",d="v-max",u="v-type",h="v-check-taken",c="v-formula",v=this.form.querySelectorAll("input"),m=0;m<v.length;m++)t=v[m],e=t.getAttribute(o),null!==e&&this.setLengthValidator(t,e),a=t.getAttribute(l),null!==a&&this.setMinValidator(t,a),n=t.getAttribute(d),null!==n&&this.setMaxValidator(t,n),i=t.getAttribute(u),null!==i&&this.setTypeValidator(t,i),r=t.getAttribute(h),null!==r&&this.setCheckTakenValidator(t,r),s=t.getAttribute(c),null!==s&&this.setFormulaValidator(t)},a.prototype.submitValidator=function(){for(var t=!0,e=0;e<this.validators.length;e++)this.validators[e].validator(this.validators[e].elem)===!1&&(t=!1);t&&this.form.submit()},a.prototype.bindSubmitValidator=function(){this.validators.length&&this.form.addEventListener("submit",function(t){t.preventDefault(),this.submitValidator.call(this)}.bind(this),!1)},a.prototype.attachWarning=function(t,e,a){t.classList.add("invalid");var n=t.nextSibling;n&&1===n.nodeType&&"UL"===n.nodeName||(t.insertAdjacentHTML("afterend",'<ul class="'+this.warningClass+'"></ul>'),n=t.nextSibling);var i=n.querySelectorAll("li."+e);0===i.length&&n.insertAdjacentHTML("beforeend",'<li class="'+e+'">'+a+"</li>")},a.prototype.removeWarning=function(t,e){var a=t.nextSibling;if(a&&1===a.nodeType&&"UL"===a.nodeName){var n=a.querySelectorAll("li."+e);n.length>0&&a.removeChild(n[0]);var i=a.querySelectorAll("li");0===i.length&&(t.parentNode.removeChild(a),t.classList.remove("invalid"))}},a.prototype.checkLength=function(t,a){var n;n="[object HTMLInputElement]"===e(a)?a:a.target||a.srcElement;var i="Length must be "+t+" characters",r="string"==typeof n.value&&n.value.length===t;return r?this.removeWarning(n,"length"):this.attachWarning(n,"length",i),r},a.prototype.checkMin=function(t,a){var n;n="[object HTMLInputElement]"===e(a)?a:a.target||a.srcElement;var i="Length must be minimum "+t+" characters",r="string"==typeof n.value&&n.value.length>=t;return r?this.removeWarning(n,"min"):this.attachWarning(n,"min",i),r},a.prototype.checkMax=function(t,a){var n;n="[object HTMLInputElement]"===e(a)?a:a.target||a.srcElement;var i="Length must be maximum "+t+" characters",r="string"==typeof n.value&&n.value.length<=t;return r?this.removeWarning(n,"max"):this.attachWarning(n,"max",i),r},a.prototype.checkType=function(t,a){var n;n="[object HTMLInputElement]"===e(a)?a:a.target||a.srcElement;var i,r,s;return"email"===t&&(i="This field must be a valid email address",s=/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i),"url"===t&&(i="This field must be a valid URL",s=/^(https?|ftp):\/\/[^\s\/$.?#].[^\s]*$/i),"numeric"===t&&(i="This field can contain numeric characters only",s=/^[0-9]*$/i),"alpha"===t&&(i="This field can contain letter characters only",s=/^[a-zA-Z]*$/i),"alphanumeric"===t&&(i="This field can contain numeric and letter characters only",s=/^[0-9a-zA-Z]*$/i),r=s.test(n.value),r?this.removeWarning(n,"type"):this.attachWarning(n,"type",i),r},a.prototype.checkTaken=function(t,a){var n;n="[object HTMLInputElement]"===e(a)?a:a.target||a.srcElement;var i,r="This value is already taken, choose another one";return"username"===t&&(i=-1===this.registeredUsernames.indexOf(n.value)),"email"===t&&(i=-1===this.registeredEmails.indexOf(n.value)),i?this.removeWarning(n,"taken"):this.attachWarning(n,"taken",r),i},a.prototype.checkFormula=function(t){var a;a="[object HTMLInputElement]"===e(t)?t:t.target||t.srcElement;var n="Invalid result",i=a.getAttribute("data-fres"),r=a.value===i;return r?this.removeWarning(a,"taken"):this.attachWarning(a,"taken",n),r},a.prototype.setLengthValidator=function(t,e){if(e=parseInt(e,10),!isNaN(e)){var a=this.checkLength.bind(this,e);this.validators.push({validator:a,elem:t}),t.addEventListener("keyup",a),t.addEventListener("focus",a),t.addEventListener("blur",a)}},a.prototype.setMinValidator=function(t,e){if(e=parseInt(e,10),!isNaN(e)){var a=this.checkMin.bind(this,e);this.validators.push({validator:a,elem:t}),t.addEventListener("keyup",a),t.addEventListener("focus",a),t.addEventListener("blur",a)}},a.prototype.setMaxValidator=function(t,e){if(e=parseInt(e,10),!isNaN(e)){var a=this.checkMax.bind(this,e);this.validators.push({validator:a,elem:t}),t.addEventListener("keyup",a),t.addEventListener("focus",a),t.addEventListener("blur",a)}},a.prototype.setTypeValidator=function(t,e){e=String(e);var a=this.checkType.bind(this,e);this.validators.push({validator:a,elem:t}),t.addEventListener("keyup",a),t.addEventListener("focus",a),t.addEventListener("blur",a)},a.prototype.setCheckTakenValidator=function(t,e){e=String(e);var a=this.checkTaken.bind(this,e);this.validators.push({validator:a,elem:t}),t.addEventListener("keyup",a),t.addEventListener("focus",a),t.addEventListener("blur",a)},a.prototype.setFormulaValidator=function(t){var e,a,n,i;n=Math.floor(89*Math.random())+10,i=Math.floor(Math.random()*(89-n-10))+10,e=String(n)+" + "+String(i)+" =",a=n+i,t.setAttribute("data-fres",a);var r=t.parentNode.querySelector(".formula");null!==r&&(r.innerHTML=e);var s=this.checkFormula.bind(this);this.validators.push({validator:s,elem:t}),t.addEventListener("keyup",s),t.addEventListener("focus",s),t.addEventListener("blur",s)},document.addEventListener("DOMContentLoaded",function(){n()},!1),t.Validator=a}(this);